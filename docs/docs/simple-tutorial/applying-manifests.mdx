---
sidebar_position: 3
---
import useBaseUrl from '@docusaurus/useBaseUrl';
import { ApplyOutput, BuildApplyOutput } from '@site/src/components/home';

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

import PackageJs from '!!raw-loader!{{CODE_PATH}}/js/simple-tutorial/generate-packages/package.js';
import BuildApplyJs from '!!raw-loader!@site/static/examples/build-apply.js';

# Applying Manifests

Anemos can apply the generated manifests to a Kubernetes cluster. There are two ways to do this:
using the `anemos apply <package>` command to apply a package directly, or using the `anemos build --apply <js-file>`
command to build and apply all manifests.

## Using the `anemos apply <package>` command

`anemos apply <package>` command takes a package argument and applies the manifests defined in that package.
The package can be in a few different formats, such as:

- A local file path to a JavaScript file such as `package.js` or `.path/to/package.js`
- A Remote URL to a JavaScript file such as <code>{useBaseUrl('/examples/hello-world.js', {absolute: true})}</code>
- A package name from the NPM registry
- A local file path to an NPM package
- A Remote URL to an NPM package

When you run the `anemos apply <package>` command, Anemos will call the `add` function of the package,
compute the diff between the current state of the cluster and the manifests generated by the package,
print the changes, and apply them if you confirm.

You can pass `-y` flag to skip the confirmation step and apply the changes directly. It is also possible
to pass options to the package with `-f` flag. Value of this flag is a path to a JSON or YAML file.
The contents of this file will be parsed and passed to the package as an `options` object.

If the value of the `-f` flag is `-`, Anemos will read the options from the standard input.

Here is an example of how to apply a package:

<CodeBlock language="bash">
  anemos apply --yes {useBaseUrl('/examples/hello-world.js', {absolute: true})} -f - &lt;&lt;EOF
  replicaCount: 3
  EOF
  <ApplyOutput />
</CodeBlock>

## Using the `anemos build --apply <js-file>` command

The `anemos build --apply <js-file>` command builds the given JavaScript file and applies the
generated manifests to the cluster. Each document group will be applied separately,
and the command will wait for the user to confirm before applying each group.

This command is useful when you want to build a complex script that uses multiple packages to
generate manifests for many applications, and you want to apply them all at once.

You can pass `-y` flag to skip the confirmation step and apply the changes directly.

Let's import two packages and apply them using the `anemos build --apply <js-file>` command:

<CodeBlock language="javascript" title="index.js" showLineNumbers>
    {BuildApplyJs.replaceAll('http://localhost:3000/', useBaseUrl('/', {absolute: true}))}
</CodeBlock>

Run the following command to apply the manifests:

```bash
anemos build --apply index.js
```

Output will be similar to the one below:

<CodeBlock language="javascript" title="index.js" showLineNumbers>
    <BuildApplyOutput />
</CodeBlock>
