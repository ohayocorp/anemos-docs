---
sidebar_position: 2
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import CodeBlock from '@theme/CodeBlock';

import PackageJs from '!!raw-loader!{{CODE_PATH}}/js/simple-tutorial/generate-packages/package.js';

# Generating Packages

Simplest way to generate a package with Anemos is to define a function that takes a builder and an optional
options object in a JavaScript file. This function can then be used to generate Kubernetes manifests. It is
also possible to create an NPM package with multiple files, but this is not the focus of this tutorial.

Let's create a file named `package.js` with the following content:

<CodeBlock language="javascript" title="package.js" showLineNumbers>
    {PackageJs}
</CodeBlock>

## Explanation

<CodeBlock language="javascript" title="index.js" showLineNumbers>
    {PackageJs.split('\n').slice(0, 1).join('\n')}
</CodeBlock>

This line defines a function that takes a `builder` and an `options` object. Users will call this function
to generate manifests. Anemos will also call this function when package is applied directly to a cluster
with `anemos apply` command.

<CodeBlock language="javascript" title="index.js" showLineNumbers={2}>
    {PackageJs.split('\n').slice(1, 6).join('\n')}
</CodeBlock>

Users may or may not provide an `options` object or the values in it. We set default values for the
options that users do not provide.

<CodeBlock language="javascript" title="index.js" showLineNumbers={8}>
    {PackageJs.split('\n').slice(7, 25).join('\n').replace('    name,', '//highlight-next-line\n    name,')}
</CodeBlock>

This code snippet is the same as the one we used in the previous section. The only difference is that we
pass the `name` as the first argument to the `addDocument` method. This is the name of the document group
that the document will belong to.

Document groups are used to organize documents. Documents in a group will be written into a folder
with the same name as the group. Documents in the same group will also be applied together, and they
will be deleted together when the package is removed.

<CodeBlock language="javascript" title="index.js" showLineNumbers={27}>
    {PackageJs.split('\n').slice(26, 48).join('\n')}
</CodeBlock>

In this code snippet, we define a Service manifest. Instead of using a YAML string, we use an object
to define the Service. The object will be converted to a YAML string by Anemos. Using this
approach, you can take advantage of JavaScript's features, such as functions and classes, to
dynamically generate your Kubernetes manifests.

<CodeBlock language="javascript" title="index.js" showLineNumbers={50}>
    {PackageJs.split('\n').slice(49, 52).join('\n')}
</CodeBlock>

Lastly, we export the `add` function so that it can be used by users and Anemos.